<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SnowFun滑雪趣 - 帶你享受滑雪的美好</title>
    <!-- style -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <link href="./style/layout.css" rel="stylesheet" />
    <link href="./style/coach-instructors.css" rel="stylesheet" />
  </head>
  <body>
    <nav class="navbar" aria-label="Light offcanvas navbar">
      <div class="container-fluid justify-content-between">
        <div class="d-flex align-items-center flex-grow-1">
          <div class="me-4 me-lg-0" id="offcanvasNavbarLightLabel">
            <a href="index.html" class="logo">
              <img src="./images/logo.svg" />
            </a>
          </div>
          <ul class="nav d-none d-lg-flex">
            <li class="nav-item">
              <a class="nav-link" href="coach-item.html">教練團隊</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">雪場資訊</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">常見問題</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">旅遊攻略</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">最新消息</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">聯絡客服</a>
            </li>
          </ul>
        </div>
        <div class="d-none d-lg-flex login">
          <button type="button" class="btn px-1 px-lg-2 login-coach">
            教練登入
          </button>
          <button
            type="button"
            class="btn btn-outline-primary px-1 px-lg-2"
            data-bs-toggle="modal"
            data-bs-target="#snowModal"
            onclick="loginModal()"
          >
            登入
          </button>
        </div>

        <button
          class="navbar-toggler d-block d-lg-none border-0"
          type="button"
          data-bs-toggle="offcanvas"
          data-bs-target="#offcanvasNavbarLight"
          aria-controls="offcanvasNavbarLight"
          aria-label="Toggle navigation"
        >
          <img src="./images/icon_hamburger.svg" />
        </button>
        <div
          class="offcanvas offcanvas-start nav-offcanvas"
          tabindex="-1"
          id="offcanvasNavbarLight"
          style="z-index: 1051"
        >
          <div class="offcanvas-header">
            <a href="index.html" class="logo">
              <img src="./images/logo.svg" height="60" />
            </a>
          </div>
          <div class="offcanvas-body">
            <ul class="navbar-nav justify-content-end flex-grow-1">
              <li class="nav-item">
                <a class="nav-link" href="#">教練團隊</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">雪場資訊</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">常見問題</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">旅遊攻略</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">最新消息</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">聯絡客服</a>
              </li>
              <li class="nav-item d-flex justify-content-between">
                <button type="button" class="btn coach-register">
                  教練註冊
                </button>
                <button
                  type="button"
                  class="btn btn-outline-primary px-1 px-lg-2"
                  onclick="loginModal()"
                  data-bs-toggle="modal"
                  data-bs-target="#snowModal"
                  data-bs-dismiss="offcanvas"
                >
                  登入
                </button>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </nav>

    <div class="container">
      <div class="row">
        <div class="">
          <ul class="nav coach-tab" id="tab" role="tablist">
            <li class="nav-item" role="presentation">
              <button class="nav-link active" id="introduction-tab" data-bs-toggle="pill" data-bs-target="#introduction" type="button" role="tab" aria-controls="introduction" aria-selected="true">
                教練介紹
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="schedule-tab" data-bs-toggle="pill" data-bs-target="#schedule" type="button" role="tab" aria-controls="schedule" aria-selected="false">
                教練課表
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="contact-tab" data-bs-toggle="pill" data-bs-target="#evaluation" type="button" role="tab" aria-controls="evaluation" aria-selected="false">
                學員評價
              </button>
            </li>
          </ul>
          <div class="tab-content" id="tabContent">
            <!-- 教練課表 -->
            <div class="tab-pane fade show active" id="introduction" role="tabpanel" aria-labelledby="introduction-tab" tabindex="0">
              教練課表
            </div>
            <!-- 教練課表 -->
            <div class="tab-pane fade" id="schedule" role="tabpanel" aria-labelledby="schedule-tab" tabindex="0">
              <div class="calendar-schedule">
                <div class="calendar-header">
                  <button id="prev-month"></button>
                  <button id="next-month"></button>
                </div>
                <div id="calendar"></div>
              </div>
            </div>
            <!-- 學員評價  -->
            <div class="tab-pane fade" id="evaluation" role="tabpanel" aria-labelledby="evaluation-tab" tabindex="0">
              學員評價
            </div>
          </div>
        </div>
      </div>
     </div>

    <!-- pc footer -->
    <footer class="footer-pc">
      <div class="container">
        <div class="row">
          <div class="col-9">
            <div>
              <img src="./images/logo_white.svg">
            </div>
            <div class="row">
              <div class="col-4">
                <ul>
                  <li>滑雪趣有限公司 </li>
                  <li>Snow Fun International Co., Ltd.</li>
                  <li>統一編號 82841380</li>
                  <li>Email : info@snowfun.com.tw</li>
                </ul>
              </div>
              <div class="col-8 align-self-end">
                <ul class="social-box">
                  <li>
                    <a href="//www.facebook.com/groups/453785412129721/" target="_blank">
                      <img src="./images/fb.svg">
                    </a>
                  </li>
                  <li><a href="//www.instagram.com/snowfunfun/" target="_blank">
                    <img src="./images/ig.svg">
                  </a></li>
                  <li><a href="#">
                      <img src="./images/tk.svg">
                    </a></li>
                  <li><a href="#">
                      <img src="./images/wc.svg">
                    </a></li>
                  <li><a href="#">
                      <img src="./images/yt.svg">
                    </a></li>
                </ui>
              </div>
            </div>
          </div>
          <div class="col-3">
            <div class="row">
              <div class="col">
                <p class="footer-title">信息</p>
                <ul class="footer-link">
                  <li><a class="link-underline link-underline-opacity-0" href="#">關於我們</a></li>
                  <li><a class="link-underline link-underline-opacity-0" href="#">常見問題</a></li>
                  <li><a class="link-underline link-underline-opacity-0" href="#">聯絡我們</a></li>
                </ul>
              </div>
              <div class="col">
                <p class="footer-title">合作</p>
                  <ul class="footer-link">
                    <li><a class="link-underline link-underline-opacity-0" href="#">成為教練</a></li>
                    <li><a class="link-underline link-underline-opacity-0" href="#">合作夥伴申請</a></li>
                  </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="d-flex justify-content-between footer-bottom">
          <ul class="row g-3">
            <li class="col"><a class="link-underline link-underline-opacity-0" href="#">網站使用聲明</a></li>
            <li class="col"><a class="link-underline link-underline-opacity-0" href="#">隱私權條款</a></li>
          </ul>
          <div>© 2024 SnowFun ALL RIGHTS RESERVED.</div>
        </div>
      </div>
    </footer>
    <!-- mb footer -->
    <footer class="footer-mb">
      <div class="container">
        <div class="row">
          <div class="col-6 d-flex justify-content-center">
              <img src="./images/logo_white.svg" width="100%">          
          </div>
          <div class="col-6 d-flex justify-content-center align-items-center">
            <ul>
              <li>滑雪趣有限公司 </li>
              <li>Snow Fun International Co., Ltd.</li>
              <li>統一編號 82841380</li>
              <li>Email : info@snowfun.com.tw</li>
            </ul>
          </div>
          <div class="row mt-3 mb-3">
            <div class="col-12 align-self-end">
              <ul class="social-box d-flex justify-content-center ">
                <li>
                  <a href="//www.facebook.com/groups/453785412129721/" target="_blank">
                    <img src="./images/fb.svg">
                  </a>
                </li>
                <li><a href="//www.instagram.com/snowfunfun/" target="_blank">
                  <img src="./images/ig.svg">
                </a></li>
                <li><a href="#">
                    <img src="./images/tk.svg">
                  </a></li>
                <li><a href="#">
                    <img src="./images/wc.svg">
                  </a></li>
                <li><a href="#">
                    <img src="./images/yt.svg">
                  </a></li>
              </ui>
            </div>
          </div>
          <div class="row">
            <div class="col-4">
              <p class="footer-title">信息</p>
                <ul class="footer-link">
                  <li><a class="link-underline link-underline-opacity-0" href="#">關於我們</a></li>
                  <li><a class="link-underline link-underline-opacity-0" href="#">常見問題</a></li>
                  <li><a class="link-underline link-underline-opacity-0" href="#">聯絡我們</a></li>
                </ul>
            </div>
            <div class="col-4">
              <p class="footer-title">合作</p>
                  <ul class="footer-link">
                    <li><a class="link-underline link-underline-opacity-0" href="#">成為教練</a></li>
                    <li><a class="link-underline link-underline-opacity-0" href="#">合作夥伴申請</a></li>
                  </ul>
            </div>
          </div>
        </div>
        <div class="d-flex justify-content-between footer-bottom">
          <ul class="row g-3">
            <li class="col"><a class="link-underline link-underline-opacity-0" href="#">網站使用聲明</a></li>
            <li class="col"><a class="link-underline link-underline-opacity-0" href="#">隱私權條款</a></li>
          </ul>
          <div>© 2024 SnowFun ALL RIGHTS RESERVED.</div>
        </div>
      </div>
    </footer>

    <!-- 登入 modal -->
    <div id="sharedModalContainer"></div>

    <!-- script -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
      integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
      integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
      crossorigin="anonymous"
    ></script>

    <script src="./js/login.js"></script> <script>
      $(document).ready(function () {
        const today = new Date();
        let currentYear = today.getFullYear();
        let currentMonth = today.getMonth() + 1;
        const currentDateStr = today.toISOString().split("T")[0];

        const events = [
          { date: "2024-07-01", 
            place: 
              [
                {
                  "title": "輕井澤",
                  "skiResort": 9,
                  "order": 4,
                  "date": "2024-07-23",
                  "bgColor": "#e5f2f0",
                  "textColor": "#109084",
                  "url": "#"
                },
                {
                  "title": "越後湯澤 岩原滑雪場",
                  "skiResort": 32,
                  "order": 3,
                  "date": "2024-07-24",
                  "bgColor": "#fcf1e1",
                  "textColor": "#836942",
                  "url": "#"
                }
              ]
          },
          { date: "2024-07-25", 
            place: 
              [
                {
                  "title": "輕井澤",
                  "skiResort": 9,
                  "order": 4,
                  "date": "2024-07-23",
                  "bgColor": "#e5f2f0",
                  "textColor": "#109084",
                  "url": "#"
                },
                {
                  "title": "越後湯澤 岩原滑雪場",
                  "skiResort": 32,
                  "order": 3,
                  "date": "2024-07-24",
                  "bgColor": "#fcf1e1",
                  "textColor": "#836942",
                  "url": "#"
                }
              ]
          },
          { date: "2024-07-30", 
            place: 
              [
                {
                  "title": "輕井澤",
                  "skiResort": 9,
                  "order": 4,
                  "date": "2024-07-23",
                  "bgColor": "#e5f2f0",
                  "textColor": "#109084",
                  "url": "#"
                },
                {
                  "title": "輕井澤2",
                  "skiResort": 9,
                  "order": 4,
                  "date": "2024-07-23",
                  "bgColor": "#eeecfd",
                  "textColor": "#5b4fa7",
                  "url": "#"
                },
                {
                  "title": "越後湯澤 岩原滑雪場",
                  "skiResort": 32,
                  "order": 3,
                  "date": "2024-07-24",
                  "bgColor": "#fcf1e1",
                  "textColor": "#836942",
                  "url": "#"
                }
              ]
          },
        ];

        function generateCalendar(year, month) {
          const monthNames = ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"];
          const daysInMonth = new Date(year, month, 0).getDate(); // 获取该月的天数
          const firstDay = new Date(year, month - 1, 1).getDay(); // 获取该月第一天是星期几

          let calendarHtml = `<table class="table"><thead><tr><th class="calendar-title" colspan="7">${year}年 ${monthNames[month - 1]}</th></tr><tr>`;
          const dayNames = ["日", "一", "二", "三", "四", "五", "六"];
          for (let day of dayNames) {
              calendarHtml += `<th>${day}</th>`;
          }
          calendarHtml += `</tr></thead><tbody>`;

          for (let i = 0; i < firstDay; i++) {
              calendarHtml += `<td></td>`;
          }

          for (let day = 1; day <= daysInMonth; day++) {
              if ((day + firstDay - 1) % 7 === 0 && day > 1) {
                  calendarHtml += `</tr><tr>`;
              }
              const dateId = `${year}-${month.toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
              let additionalClass = dateId < currentDateStr ? 'before-day' : '';
              calendarHtml += `<td id="${dateId}" class="${additionalClass}"><div class="calendar-date">${day}</div></td>`;
          }
          calendarHtml += `</tr></tbody></table>`;

          $('#calendar').html(calendarHtml);
          
          // 标记日期
          markDates(events);
        }

        
        function markDates(events) {
            events.forEach(event => {
                const date = event.date;
                const places = event.place;
                const dateElement = $(`#${date}`);
                if (dateElement.length) {
                    // 显示第一个地点
                    const firstPlace = places[0];
                    dateElement.append(`<span class="tag" style="background-color:${firstPlace.bgColor}; color:${firstPlace.textColor};">${firstPlace.title}</span>`);
                    if (places.length > 1) {
                        dateElement.append(`<button class="more-btn btn btn-link" data-bs-toggle="collapse" data-bs-target="#collapse-${date}">+more</button>`);
                    }

                    // 初始化时插入 MoreInfo 行
                    let moreInfoHtml = `<tr class="more-info"><td colspan="7"><div class="collapse text-start" id="collapse-${date}"><div class="more-info-content">`;
                    moreInfoHtml += places.map(place => `<span class="tag" style="background-color:${place.bgColor}; color:${place.textColor};">${place.title}</span>`).join(" ");
                    moreInfoHtml += `</div></div></td></tr>`;
                    // 找到当前日期所在的行
                    const currentRow = dateElement.closest('tr');
                    // 在当前行的下方插入详细信息行
                    currentRow.after(moreInfoHtml);
                }
            });
        }
        function changeMonth(offset) {
          currentMonth += offset;
          if (currentMonth > 12) {
            currentMonth = 1;
            currentYear++;
          } else if (currentMonth < 1) {
            currentMonth = 12;
            currentYear--;
          }
          generateCalendar(currentYear, currentMonth);
        }

        $("#prev-month").click(function () {
          changeMonth(-1);
        });

        $("#next-month").click(function () {
          changeMonth(1);
        });

        let currentExpanded = null;
        $(document).on("click", ".more-btn", function () {
          const target = $(this).data("bs-target");
          if (currentExpanded && currentExpanded !== target) {
            $(currentExpanded).collapse("hide");
          }

          $(target).collapse("toggle");

          $(".active-day").removeClass("active-day");
          const parentTd = $(this).closest("td");
          parentTd.addClass("active-day");
          if (currentExpanded === target) {
            $(".active-day").removeClass("active-day");
            currentExpanded = null;
          } else {
            currentExpanded = target;
          }
        });

        generateCalendar(currentYear, currentMonth); // init
      });
    </script>
  </body>
</html>
